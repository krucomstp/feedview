<script src="../../jquery.js"></script>
<link href="../../netpie.theme.css" rel="stylesheet" />
<script src="../../netpie.feedview.js"></script>
<script>
	var parameter = {feedname:null,apikey:null,granularity:"15minutes",since:"24hours"};
	var option = {};
    var path = window.location.href.split('?');
    var params = path[1].split('&');
    for (var i = 0; i < params.length; i++) {
        var nv = params[i].split('=');
        if (!nv[0]) continue;
        if(nv[0]=="feedname"||nv[0]=="apikey"||nv[0]=="granularity"||nv[0]=="since"){
        	parameter[nv[0]] = decodeURIComponent(nv[1].replace(/\+/g,  " "));
        }
        else{
        	option[nv[0]] = decodeURIComponent(nv[1].replace(/\+/g,  " "));
        }
    }
</script>

<body style="margin: 0px;overflow: hidden;background-color: inherit;" id="body">
	<div style="width:100vw;height:100vh;" id="main">
	    <div id="chart"></div>
	</div>
    <script>
        if(parameter["feedname"]!=null&parameter["apikey"]!=null){
            setInterval(function insertGraph() {
                $.getJSON( "https://api.netpie.io/feed/"+parameter["feedname"]+"?apikey="+parameter["apikey"]+"&granularity="+parameter["granularity"]+"&since="+parameter["since"], function(datajson) {
                    updateChart('chart',datajson,option);
                });
                return insertGraph;
            }(), 150000);
        }
        else{
            $('#chart').html('Error : Feedname and/or Apikey is undefined.<br><br>Please check again.')
            $('#main').css({
                margin: "0",
                padding: "0",
                display: "table"
            })
            $('#chart').css({
                display: "table-cell",
                "text-align": "center",
                "vertical-align": "middle",
                backgroundColor: "#F1F1F1",
                font: '14px/0.8em Trebuchet, Arial, sans-serif',
            })
        }
    </script>
</body>